carnx_lacking_councillors_modifier = {
	first_valid = {
		modifier = {
			carnx_has_max_councillor_skill_difference_trigger = {
				NAME = chancellor
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_councillor_skill_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_chancellor_reason
		}
		modifier = {
			carnx_has_max_councillor_skill_difference_trigger = {
				NAME = marshal
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_councillor_skill_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_marshal_reason
		}
		modifier = {
			carnx_has_max_councillor_skill_difference_trigger = {
				NAME = steward
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_councillor_skill_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_steward_reason
		}
		modifier = {
			carnx_has_max_councillor_skill_difference_trigger = {
				NAME = spymaster
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_councillor_skill_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_spymaster_reason
		}
	}
}

carnx_lacking_court_positions_modifier = {
	first_valid = {
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = court_physician
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_court_physician_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = antiquarian
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_antiquarian_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = court_gardener
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_court_gardener_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = wet_nurse
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_wet_nurse_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = court_tutor
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_court_tutor_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = food_taster
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_food_taster_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = seneschal
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_seneschal_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = cupbearer
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_cupbearer_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = chief_eunuch
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_chief_eunuch_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = court_jester
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_court_jester_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = court_poet
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_court_poet_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = court_musician
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_court_musician_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = bodyguard
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_bodyguard_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = champion
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_champion_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = executioner
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_executioner_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = master_assassin
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_master_assassin_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = chronicler
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_chronicler_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = slave_concubine
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_slave_concubine_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = slave_captain
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_slave_captain_reason
		}
		modifier = {
			carnx_has_max_aptitude_difference_trigger = {
				NAME = slave_eunuch
				RULER = $RULER$
				SLAVE = $SLAVE$
			}
			add = {
				value = scope:max_aptitude_difference
				multiply = $SCALE$
			}
			desc = carnx_lacking_slave_eunuch_reason
		}
	}
}

carnx_lacking_knights_modifier = {
	compare_modifier = {
		trigger = {
			$SLAVE$ = {
				carnx_can_serve_as_knight_trigger = { RULER = $RULER$ }
			}
		}
		target = $SLAVE$
		value = prowess
		offset = {
			value = 0
			subtract = carnx_default_skill_threshold
		}
		multiplier = $SCALE$
		desc = "carnx_lacking_knights_reason"
	}
}

carnx_lacking_commanders_modifier = {
	compare_modifier = {
		trigger = {
			$SLAVE$ = {
				carnx_can_serve_as_commander_trigger = { RULER = $RULER$ }
			}
		}
		target = $SLAVE$
		value = carnx_commander_skill_value
		multiplier = $SCALE$
		desc = "carnx_lacking_commanders_reason"
	}
}

carnx_family_and_relations_modifier = {
	modifier = {
		$SLAVE$ = {
			carnx_is_family_or_positive_relation_trigger = { CHARACTER = $RULER$ }
		}
		add = {
			value = $SCALE$
			if = {
				limit = {
					$SLAVE$ = {
						OR = {
							is_child_of = $RULER$
							has_relation_best_friend = $RULER$
							has_relation_soulmate = $RULER$
						}
					}
				}
				multiply = 4
			}
			else_if = {
				limit = {
					$SLAVE$ = {
						OR = {
							is_close_family_of = $RULER$
							has_relation_friend = $RULER$
							has_relation_lover = $RULER$
							has_secret_relation_lover = $RULER$
							has_relation_crush = $RULER$
							is_spouse_of = $RULER$
						}
					}
				}
				multiply = 3
			}
			else_if = {
				limit = {
					$SLAVE$ = {
						is_close_or_extended_family_of = $RULER$
					}
				}
				multiply = 2
			}
		}
		desc = "DEAR_TO_ME_REASON"
	}
}

carnx_claims_modifier = {
	modifier = {
		$SLAVE$ = {
			carnx_has_useful_claims_trigger = { RULER = $RULER$ }
		}
		add = $SCALE$
		desc = "carnx_secondary_recipient_claims_reason"
	}
}

carnx_attraction_modifier = {
	modifier = {
		$SLAVE$ = {
			carnx_is_attractive_to_character_trigger = { CHARACTER = $RULER$ }
			NOT = { carnx_can_serve_as_slave_concubine_trigger = { RULER = $RULER$ } }
		}
		add = {
			value = $SLAVE$.attraction
			divide = high_positive_attraction
			multiply = $SCALE$
			if = {
				limit = { $RULER$ = { has_trait = lustful } }
				multiply = 2
			}
			else_if = {
				limit = { $RULER$ = { has_trait = chaste } }
				multiply = 0.5
			}
			floor = yes
		}
		desc = "carnx_secondary_recipient_attraction_reason"
	}
}

carnx_female_modifier = {
	modifier = {
		$SLAVE$ = {
			carnx_is_visibly_fertile_female_trigger = yes
		}
		add = $SCALE$
		desc = "carnx_secondary_recipient_female_reason"
	}
}

carnx_age_modifier = {
	modifier = {
		OR = {
			$SLAVE$.carnx_age_value < carnx_prime_age_min_value
			$SLAVE$.carnx_age_value > carnx_prime_age_max_value
		}
		add = {
			value = 0
			if = {
				limit = { $SLAVE$.carnx_age_value < carnx_prime_age_min_value }
				add = {
					value = carnx_prime_age_min_value
					subtract = $SLAVE$.carnx_age_value
					divide = {
						value = carnx_prime_age_min_value
						subtract = carnx_young_zero_age_value
					}
					multiply = $SCALE$
					floor = yes
				}
			}
			else_if = {
				limit = { $SLAVE$.carnx_age_value > carnx_prime_age_max_value }
				add = {
					value = $SLAVE$.carnx_age_value
					subtract = carnx_prime_age_max_value
					divide = {
						value = carnx_old_zero_age_value
						subtract = carnx_prime_age_max_value
					}
					multiply = $SCALE$
					floor = yes
				}
			}
		}
		desc = "carnx_secondary_recipient_age_reason"
	}
}

carnx_base_price_modifier = {
	modifier = {
		$SLAVE$.carnx_slave_base_price_value < $RULER$.minor_gold_value
		add = $SCALE$
		desc = "carnx_secondary_recipient_cheap_reason"
	}
	modifier = {
		$SLAVE$.carnx_slave_base_price_value > $RULER$.major_gold_value
		add = { value = $SCALE$ multiply = -1 }
		desc = "carnx_secondary_recipient_expensive_reason"
	}
}

carnx_ask_price_modifier = {
	modifier = {
		$RULER1$ = { save_temporary_scope_as = seller }
		$SLAVE$.carnx_slave_ask_price_value < $RULER2$.minor_gold_value
		add = $SCALE$
		desc = "carnx_secondary_recipient_cheap_reason"
	}
	modifier = {
		$RULER1$ = { save_temporary_scope_as = seller }
		$SLAVE$.carnx_slave_ask_price_value > $RULER2$.major_gold_value
		add = { value = $SCALE$ multiply = -1 }
		desc = "carnx_secondary_recipient_expensive_reason"
	}
}

carnx_bid_price_modifier = {
	modifier = {
		$RULER1$ = { save_temporary_scope_as = buyer }
		$SLAVE$.carnx_slave_bid_price_value < $RULER2$.minor_gold_value
		add = $SCALE$
		desc = "carnx_secondary_recipient_cheap_reason"
	}
	modifier = {
		$RULER1$ = { save_temporary_scope_as = buyer }
		$SLAVE$.carnx_slave_bid_price_value > $RULER2$.major_gold_value
		add = { value = $SCALE$ multiply = -1 }
		desc = "carnx_secondary_recipient_expensive_reason"
	}
}

carnx_employed_modifier = {
	modifier = {
		$SLAVE$ = {
			is_councillor_of = $RULER$
		}
		add = { value = $SCALE$ multiply = 2 }
		desc = "carn_secondary_recipient_is_my_councillor_reason"
	}
	modifier = {
		$SLAVE$ = {
			has_any_court_position = yes
			any_court_position_employer = { this = $RULER$ }
		}
		add = { value = $SCALE$ multiply = 2 }
		desc = "carnx_secondary_recipient_has_court_position_reason"
	}
	modifier = {
		$SLAVE$ = {
			OR = {
				is_knight_of = $RULER$
				is_commanding_army = yes
			}
		}
		add = $SCALE$
		desc = "carn_secondary_recipient_is_my_knight_reason"
	}
	modifier = {
		$SLAVE$ = {
			carnx_has_important_role_trigger = { RULER = $RULER$ }
		}
		add = $SCALE$
		desc = "carnx_secondary_recipient_has_important_role_reason"
	}
}

carnx_execute_reason_modifier = {
	modifier = {
		carnx_has_execute_reason_slave_trigger = { CHARACTER = $SLAVE$ RULER = $RULER$ }
		add = {
			value = $SCALE$
			if = {
				limit = { has_relation_nemesis = $SLAVE$ }
				multiply = 2
			}
		}
		desc = "carnx_secondary_recipient_criminal_reason"
	}
}

# Override in compatibility mods
carnx_slavery_modifier = {
	modifier = {
		exists = $SLAVE$
		$ACTION$ = flag:none
		always = no
		add = 0
	}
}

carnx_capture_chance_modifier = {
	modifier = {
		$WINNER$ = {
			carnx_is_slavery_accepted_trigger = { CHARACTER = prev }
		}
		add = carnx_slave_base_price_value
	}
	modifier = {
		$WINNER$ = {
			carnx_is_slavery_shunned_trigger = { CHARACTER = prev }
		}
		add = {
			value = carnx_slave_base_price_value
			divide = 2
		}
	}
}
